' Gambas class file

Public Sub Form_Open()
  
  Me.Title = ("Configuraci√≥n")
  Me.center
  ' TextArea1.ToColumn(1)
  ' TextArea1.ToLine(1)
  
  actualizaControles()
  
End

Public Sub FontChooserTipoLetra_Change()
  
  TextArea1.font = Font[FontChooserTipoLetra.Value]
  
  TextArea1.Refresh()
  
End

Public Sub ColorButtonColorTexto_Change()
  
  TextArea1.Foreground = ColorButtonColorTexto.Value
  
End

Public Sub ColorButtonColorFondo_Change()
  
  TextArea1.Background = ColorButtonColorFondo.Value
  
End

Public Sub ButtonSalir_Click()
  
  Me.Close()
  
End

Public Sub TextArea1_DblClick()
  
  Dim numeropalabras As Integer
  Dim textoAcontar As String
  
  numeropalabras = ModuleComun.contarPalabras(textArea1.text, TextArea1.pos)
  ' Print "Numero de palabras: ", numeropalabras
  
  LabelPalabrasLeidas.text = ("Palabras leidas") & ":" & numeropalabras
  
End

Public Sub ButtonGuardarYSalir_Click()
  'guardos cambios de configuracion
  
  Settings["colorfondo"] = ColorButtonColorFondo.Value
  Settings["colorletra"] = ColorButtonColorTexto.Value
  Settings["tiempo"] = ValueBoxTiempo.value 
  Settings["TipoLetra"] = FontChooserTipoLetra.Value
  Settings["GrabarLocucion"] = CheckBoxGrabarLocucion.value
  Settings["cuantaAtras"] = ValueBoxCuentaAtras.value 
  Me.Close()
  
End

Public Sub CheckBoxGrabarLocucion_Click()
  ''TODO: Pendiente de activar o no la grabacion de la lectura
  ''
  
End

Public Sub ButtonValoresPorDefecto_Click()
  
  Settings["colorfondo"] = Color.RGB(245, 245, 200) 'color calido
  Settings["colorletra"] = Color.Black 'color negro para la letra
  Settings["tiempo"] = 90
  
  Settings["TipoLetra"] = "M&M,+8"
  Settings["GrabarLocucion"] = False
  Settings["cuantaAtras"] = 5
  
  actualizaControles()
  
End

Public Sub actualizaControles()
  'leo configuracion...
  
  ColorButtonColorFondo.Value = Settings["colorfondo", Color.RGB(245, 245, 200)] 
  ColorButtonColorTexto.Value = Settings["colorletra", Color.Black]
  FontChooserTipoLetra.Value = Settings["TipoLetra", "M&M,+8"]  
  CheckBoxGrabarLocucion.Value = Settings["GrabarLocucion", False] 
  ValueBoxCuentaAtras.value = Settings["cuantaAtras", 5]
  ValueBoxTiempo.value = Settings["tiempo", 90]
  
  'actualizo valores del textarea
  TextArea1.Background = ColorButtonColorFondo.Value
  TextArea1.Foreground = ColorButtonColorTexto.Value
  TextArea1.font = Font[FontChooserTipoLetra.Value]
  
  TextArea1.Pos = 1
  
End
