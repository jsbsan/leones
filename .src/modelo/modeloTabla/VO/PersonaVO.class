' Gambas class file

Property idpersona As Integer 
Private hidpersona As Integer

Property nombre As String 
Private hnombre As String

Property nivel As String 
Private hnivel As String

Property clase As String 
Private hclase As String

Property password As String 
Private hpassword As String

Property tipo As String 
Private htipo As String

Property campo As String[] 
Private hcampo As New String[]

Property campotipo As String[] 
Private hcampotipo As New String[]

Property campovisible As String[] 
Private hcampovisible As New String[]

Private Function idpersona_read() As Integer
  
  Return hidpersona 
  
End 

Private Sub idpersona_write(Valor As Integer)
  
  hidpersona = Valor 
  
End  

Private Function nombre_read() As String
  
  Return hnombre 
  
End 

Private Sub nombre_write(Valor As String)
  
  hnombre = Valor 
  
End  

Private Function nivel_read() As String
  
  Return hnivel 
  
End 

Private Sub nivel_write(Valor As String)
  
  hnivel = Valor 
  
End  

Private Function clase_read() As String
  
  Return hclase 
  
End 

Private Sub clase_write(Valor As String)
  
  hclase = Valor 
  
End  

Private Function password_read() As String
  
  Return hpassword 
  
End 

Private Sub password_write(Valor As String)
  
  hpassword = Valor 
  
End  

Private Function tipo_read() As String
  
  Return htipo 
  
End 

Private Sub tipo_write(Valor As String)
  
  htipo = Valor 
  
End  

Private Function campo_read() As String[]
  
  Return hcampo 
  
End 

Private Sub campo_write(Valor As String[])
  
  hcampo = Valor 
  
End  

Private Function campotipo_read() As String[]
  
  Return hcampotipo 
  
End 

Private Sub campotipo_write(Valor As String[])
  
  hcampotipo = Valor 
  
End  

Private Function campovisible_read() As String[]
  
  Return hcampovisible 
  
End 

Private Sub campovisible_write(Valor As String[])
  
  hcampovisible = Valor 
  
End  

Public Function Copia(Optional dato As PersonaVO) As PersonaVO

  Dim datoVOtmp As New PersonaVO
  Dim datoVOtmpOriginal As PersonaVO

  If IsNull(dato) Then
    dato = Me 'se copia a si mismo
  Endif
  datoVOtmp.idpersona = dato.idpersona
  datoVOtmp.nombre = dato.nombre
  datoVOtmp.nivel = dato.nivel
  datoVOtmp.clase = dato.clase
  datoVOtmp.password = dato.password
  datoVOtmp.tipo = dato.tipo
  Return datoVOtmp

End

Public Function ConvertirVOaColeccion(dato As PersonaVO) As Collection

  Dim colecciontmp As New Collection
  colecciontmp.add(dato.idpersona, "idpersona")
  colecciontmp.add(dato.nombre, "nombre")
  colecciontmp.add(dato.nivel, "nivel")
  colecciontmp.add(dato.clase, "clase")
  colecciontmp.add(dato.password, "password")
  colecciontmp.add(dato.tipo, "tipo")
  Return colecciontmp

End

Public Function ConvertirColeccionaVO(dato As Collection) As PersonaVO

  Dim datoVOtmp As New PersonaVO
  Try datoVOtmp.idpersona = dato["idpersona"]
  Try datoVOtmp.nombre = dato["nombre"]
Try datoVOtmp.nivel = dato["nivel"]
Try datoVOtmp.clase = dato["clase"]
Try datoVOtmp.password = dato["password"]
Try datoVOtmp.tipo = dato["tipo"]
Return datoVOtmp
End
